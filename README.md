## Обработка изображений цифровой рентгенографии органов грудной клетки методами компьютерного зрения ##

# О проекте #

Цель проекта - провести статистический и исследовательский анализ датасета и построить модель компьютерного зрения для улучшения качества изображений цифровой рентгенографии ОГК. Результат работы может быть использован для снижения ошибки в моделях классификации для определения признаков патологии органов грудной клетки, в клинической практике для поддержки принятия решений врачом. Используется датасет NIH X-rays.

# Используемый датасет #

Датасет есть в открытом доступе на Kaggle: https://www.kaggle.com/datasets/nih-chest-xrays/data    

Источники данных: PACS-система Клинического центра Национального института здравоохранения в Бетесде, штат Мэриленд, включает ~60% всех собранных изображений цифровой рентгенографии во фронтальной проекции.  

Описание датасета: 112120 изображений цифровой рентгенографии во фронтальной проекции от 30805 уникальных пациентов. Использованы 14 лейблов заболеваний, некоторые изображения могут быть мультилейбельны:разметка лейблов создана с помощью NLP из прилагающихся описаний к снимкам.

Использованные лейблы: 
* Ателектаз
* Консолидация
* Инфильтрация
* Отёк
* Пневматоракс
* Эмфизема 
* Фиброз
* Выпот
* Пневмония
* Утолщение плевры
* Кардиомегалия 
* Узловые образования
* Грыжа 
* Массивное образование
Точность текстовых лейблов >90%. 


Структура датасета:
1. 112120 изображений цифровой рентгенографии во фронтальной проекции в формате PNG,  разрешение 1024*1024 
2. Метаданные к изображениям (Data_Entry_2017.csv): индекс изображения (Image Index), найденные лейблы (Finding Labels), описание (Follow-up #), идентификатор пациента (Patient ID), возраст пациента (Patient Age), пол пациента (Patient Gender), проекция (View Position), размер оригинального изображения (Original Image Size) и само изображение (Original Image), шаг пикселя (Pixel Spacing)
3. Ограничивающие объемы (параллелепипеды) для ~1000 images : индекс изображения (Image Index), найденные лейблы (Finding Label),
сам параллелепипед (Bbox[x, y, w, h]). [x y] - координаты верхнего левого угла каждого Bbox. [w h] определяют ширину и высоту соответственно.
4. Два файла с разделёнными данными (train_val_list.txt и test_list.txt). Все изображения датасета раздлеена на 2 сета так, что данные по одному пациенту находятся только в одном из сетов. Таким образом, один пациент не может попасть и в тренировочный, и в валидационный сет.

# Используемые библиотеки, модули и подмодули #

opendatasets - загрузка датасета
matplotlib (.image, .pyplot) - визуализация матрицы корреляции признаков, гистограмм демографических показателей и распределения лейблов по демографическим показателям, визуализация изображений
numpy - стандартные операции с массивами: подсчёт частот встречаемости категориальных признаков, сортировка, алгебраические операции с числовыми данными. 
pandas - форматирование, специальные структуры данных, операции для манипулированиям данными: загрузка, изучение датасета, очистка 
requests -  
seaborn - визуализация статистических данных: гистограммы частот встречаемости признаков при исследовательском анализе,
tensorflow - 
OpenCV - операции с изображениями для построения модели компьютерного зрения  
PIL (Image, ImageEnhance, ImageFilter) - операции с изображениями для создания модели компьютерного зрения 
SciPy (stats) - статистический анализ данных: расчёт метрик, Т-тест

random - выбор образцов данных для визуализации и изучения

Операции над файлами и директориями: 

glob - обработка файлов
io (StringIO, BytesIO) - работа с потоками, типами ввода - вывода 
os - работа с директориями  
shutil - операции над файлами и директориями

Другое: 

API kaggle - доступ к наборам данных с помощью клиента 

# План проекта # 

1. Изучение и подготовка датасета: загрузка, очистка, предобработка данных 
2. Анализ структуры датасета: расчёт корреляции между признаками, визуализация в виде матрицы корреляции. Анализ структуры демографических показателей: возраста, пола, визуализация распределения в виде гистограмм.
3. Изучение изображений: визуализация пяти случайных образцов из датасета
4. Исследовательский анализ данных: подсчёт частоты встречаемости лейблов, поиск самых частых лейблов и визулизация в виде гистограммы. Поиск самых частых лейблов, распределение лейблов без здоровых людей. Распределение самых частых патологий по полу, визуализация. Сравнение возраста больных и здоровых пациентов, больных и здоровых по полу, визуализация. Формулировка выводов исследовательского этапа анализа.
5. Статистический анализ данных: формулировка нулевой гипотезы. Расчёт стандартных статистических метрик. Т-тест. Выводы относительно нулевой гипотезы.
6. Построение модели компьютерного зрения: предобработка данных, реализация модели.
7. Общие выводы

--------------------------------------------------------------
# Список авторов #

- Катаева Наталья, nskataeva@yandex.ru, Product-manager, Lead Developer 
- Арутюн Агабабян, supatemiooo@gmail.com, Data Analyst, статистические тесты   
- Анастасия Балашова, anastasia_balash-ova@mail.ru, Data Analyst, Markdown, комментирование      
- Александр Захаров, alexander.zakharov1977@gmail.com, Scientific Consultant, интерпретация клинической ценности результатов
- Александр Ващенко, alexanderva@mail.ru, Team Lead, project-manager 
- Анастасия Бромберг, silhouette0.55@yandex.ru, описание и визуализация проекта, readme  



